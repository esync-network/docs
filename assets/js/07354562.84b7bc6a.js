"use strict";(self.webpackChunkdocu=self.webpackChunkdocu||[]).push([[338],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>h});var o=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,o,n=function(e,t){if(null==e)return{};var a,o,n={},r=Object.keys(e);for(o=0;o<r.length;o++)a=r[o],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)a=r[o],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var s=o.createContext({}),p=function(e){var t=o.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},c=function(e){var t=p(e.components);return o.createElement(s.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=p(a),m=n,h=d["".concat(s,".").concat(m)]||d[m]||u[m]||r;return a?o.createElement(h,i(i({ref:t},c),{},{components:a})):o.createElement(h,i({ref:t},c))}));function h(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,i=new Array(r);i[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[d]="string"==typeof e?e:n,i[1]=l;for(var p=2;p<r;p++)i[p]=a[p];return o.createElement.apply(null,i)}return o.createElement.apply(null,a)}m.displayName="MDXCreateElement"},1317:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>u,frontMatter:()=>r,metadata:()=>l,toc:()=>p});var o=a(7462),n=(a(7294),a(3905));const r={sidebar_position:5},i="Operation and Maintenance",l={unversionedId:"validators/node_maintenance",id:"validators/node_maintenance",title:"Operation and Maintenance",description:"Once your Validator Node is up and running, it's important to keep it that way. To help keep your node running smoothly, please see the following tips and instructions.",source:"@site/docs/validators/node_maintenance.md",sourceDirName:"validators",slug:"/validators/node_maintenance",permalink:"/docs/validators/node_maintenance",draft:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"validators",previous:{title:"Personal Node Setup",permalink:"/docs/validators/personal_node_setup"},next:{title:"Quick Command Reference",permalink:"/docs/validators/quick_reference"}},s={},p=[{value:"Updates",id:"updates",level:2},{value:"Monitoring",id:"monitoring",level:2},{value:"Monitor the blockchain",id:"monitor-the-blockchain",level:3},{value:"Monitor your node",id:"monitor-your-node",level:3},{value:"Voting",id:"voting",level:2},{value:"Backup",id:"backup",level:2},{value:"How can I backup my keystore file?",id:"how-can-i-backup-my-keystore-file",level:3},{value:"How can I restore my keystore file?",id:"how-can-i-restore-my-keystore-file",level:3}],c={toc:p},d="wrapper";function u(e){let{components:t,...a}=e;return(0,n.kt)(d,(0,o.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"operation-and-maintenance"},"Operation and Maintenance"),(0,n.kt)("p",null,"Once your Validator Node is up and running, it's important to keep it that way. To help keep your node running smoothly, please see the following tips and instructions. "),(0,n.kt)("h2",{id:"updates"},"Updates"),(0,n.kt)("p",null,"As with any computer system, it's crucial that your node remains up to date and secure. Therefore, please regularly update your node's operating system!"),(0,n.kt)("p",null,"Updates to the eCredits Docker container will be communicated via the community channels like our Elements channel."),(0,n.kt)("h2",{id:"monitoring"},"Monitoring"),(0,n.kt)("p",null,"As your Validator Node is part of the eCredits community and is a crucial element of the entire ecosystem, it's important that you keep it up and validating as much as possible. To do so - and to recognize if, for example, a power outage stopped your validating process - we suggest establishing proper monitoring for your node."),(0,n.kt)("p",null,"To do so, you can:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Monitor the blockchain if your node has recently validated a block"),(0,n.kt)("li",{parentName:"ol"},"Monitor the Geth metrics of the Docker container"),(0,n.kt)("li",{parentName:"ol"},"Monitor the hardware you're running the node on")),(0,n.kt)("h3",{id:"monitor-the-blockchain"},"Monitor the blockchain"),(0,n.kt)("p",null,"The blockchain provides access to information that is available via the RPC endpoints. As the eCredits Blockchain is based on Ethereum, you can use the Ethereum RPC libraries to connect to the node."),(0,n.kt)("p",null,"You can query the RPC endpoint on your own node to collect this information and verify if your node had validated a block within the last 300 validated blocks."),(0,n.kt)("p",null,"If so, your node is validating as it should."),(0,n.kt)("p",null,"We also recommend you monitor the uptime via the blockchain RPC endpoints and check if your Validator Node has validated a block recently. This will show you if it's still running properly, or if you should take action if it's not fast and reliable as it should be. "),(0,n.kt)("h3",{id:"monitor-your-node"},"Monitor your node"),(0,n.kt)("p",null,"If activated, your node also directly provides metrics in prometheus format that you can monitor and process. To activate these metric endpoints, be sure to have the following options in you Docker-compose file:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-yaml"},"- --metrics\n- --metrics.addr 0.0.0.0\n- --metrics.expensive\n")),(0,n.kt)("admonition",{type:"info"},(0,n.kt)("p",{parentName:"admonition"},"Please be sure to allow port 6060/TCP on your node's firewall so you can access the metrics!")),(0,n.kt)("p",null,"More information about those metrics can be found ",(0,n.kt)("a",{parentName:"p",href:"https://geth.ethereum.org/docs/monitoring/metrics"},"here"),"."),(0,n.kt)("h2",{id:"voting"},"Voting"),(0,n.kt)("p",null,"You can vote for other validators to be added or expelled from the group of validators. This will happen if others want to join, as they need to have the majority of validators vote for them in order to join the group."),(0,n.kt)("p",null,"To vote for a validator to be accepted, you can invoke the following command:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},'docker exec -it ecredits_ecs-validator_1 geth attach\nclique.propose("0x....", true)\n')),(0,n.kt)("p",null,"or"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"docker exec -it ecredits_ecs-validator_1 geth --exec 'clique.propose(\"0x....\", true)' attach\n")),(0,n.kt)("p",null,"Sometimes a validator needs to be removed from the group as it's no longer validating or no longer wishes to run a node.\nTo remove a validator from the network you can run the following command:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},'docker exec -it ecredits_ecs-validator_1 geth attach\nclique.propose("0x....", false)\n')),(0,n.kt)("p",null,"or"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"docker exec -it ecredits_ecs-validator_1 geth --exec 'clique.propose(\"0x....\", false)' attach\n")),(0,n.kt)("h2",{id:"backup"},"Backup"),(0,n.kt)("h3",{id:"how-can-i-backup-my-keystore-file"},"How can I backup my keystore file?"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Making local copy of keystore")),(0,n.kt)("p",{parentName:"li"},"Access the validator's terminal, follow these steps:\nPress Ctrl + Alt + T to open the terminal."),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"cd /var/lib/eCredits/datadir/\n\nsudo bash\n\ncd keystore\n\nls\n")),(0,n.kt)("p",{parentName:"li"},"Record the filename from the output."),(0,n.kt)("p",{parentName:"li"},"To ensure a local backup of the keystore file, execute the following command to copy the keystore file:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"sudo cp -R /var/lib/eCredits/datadir/keystore/<filename> ~/\n")),(0,n.kt)("p",{parentName:"li"},'Replace "filename" with the keystore file name.')),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Preparing keystore file for back up")),(0,n.kt)("p",{parentName:"li"},"To ensure a successful backup of the file, it is crucial to set the correct ownership.\nYou can grant the proper ownership to the keystore file by executing the following command:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"sudo chown <username> <filename>\n")),(0,n.kt)("p",{parentName:"li"},'Replace "filename" with the keystore file name.')),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Back up of keystore file")),(0,n.kt)("p",{parentName:"li"},"For creating a secure backup of the keystore file from your Validator Node, you can utilize SCP (Secure Copy Protocol):"),(0,n.kt)("p",{parentName:"li"},"SCP provides a reliable and straightforward way to copy the keystore file between your validator and backup machine while ensuring secure file",(0,n.kt)("br",{parentName:"p"}),"\n","transfer through SSH (Secure Shell). To learn more about SCP and its functionalities, you can find additional information at the following\nlink: ",(0,n.kt)("a",{parentName:"p",href:"https://linux.die.net/man/1/scp"},"https://linux.die.net/man/1/scp")),(0,n.kt)("p",{parentName:"li"},"To initiate the keystore file transfer from the Validator Node to your backup machine, please follow these steps:"),(0,n.kt)("p",{parentName:"li"},"On your backup machine, open Command Prompt or PowerShell. You can do this by:"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"Command Prompt: Press Windows 'Key + R' to open the Run dialog, type 'cmd', and press Enter."),(0,n.kt)("li",{parentName:"ul"},"PowerShell: Press Windows 'Key + X', then select \"Windows PowerShell\" from the menu.")),(0,n.kt)("p",{parentName:"li"},"Utilize the following command to copy the keystore file from the validator to the backup machine:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"scp <username>@<validator_ip>:~/<filename> path/to/destination/folder\n")),(0,n.kt)("p",{parentName:"li"},"To proceed with the keystore file backup, substitute the following placeholders with your specific information:"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},'Replace "username" with your validator username.'),(0,n.kt)("li",{parentName:"ul"},'Replace "validator_ip" with the IP address of your validator.'),(0,n.kt)("li",{parentName:"ul"},'Replace "filename" with the actual keystore file name that you wish to back up.'),(0,n.kt)("li",{parentName:"ul"},'Modify "/path/to/destination/folder" to the desired folder location on the backup machine where you want to save the file.')),(0,n.kt)("admonition",{parentName:"li",type:"info"},(0,n.kt)("p",{parentName:"admonition"},"Make sure the file is backed up on your backup machine!")))),(0,n.kt)("h3",{id:"how-can-i-restore-my-keystore-file"},"How can I restore my keystore file?"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Restoring the keystore file to validator")),(0,n.kt)("p",{parentName:"li"},"Restoring your keystore file is a straightforward process if you have a backup. Simply follow these steps to successfully restore it:"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Ensure you have a backup of your keystore file.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Add the backup file to the folder '/var/lib/eCredits/datadir/keystore' on your validator."),(0,n.kt)("admonition",{parentName:"li",type:"info"},(0,n.kt)("p",{parentName:"admonition"},"Please note that the specific approach to restoring may vary depending on your chosen backup strategy. Here's one example of how you can\nperform the restoration. Adapt the steps accordingly based on your situation:"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Access your validator.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Navigate to the location of your keystore backups.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Copy the desired keystore backup file to the '/var/lib/eCredits/datadir/keystore' folder on your validator."))),(0,n.kt)("p",{parentName:"li"},"By following these steps, your keystore file will be successfully restored, provided you have a valid backup in place."),(0,n.kt)("admonition",{parentName:"li",type:"info"},(0,n.kt)("p",{parentName:"admonition"},"Before proceeding with any SSH-related tasks, ensure that OpenSSH-Server is installed on your validator. If it's not installed, you can use the\nfollowing commands to install it:"),(0,n.kt)("pre",{parentName:"admonition"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"sudo apt update\n\nsudo apt install openssh-server\n")),(0,n.kt)("p",{parentName:"admonition"}," :::"),(0,n.kt)("p",{parentName:"admonition"}," On your backup machine where your keystore file is located, open Command Prompt or PowerShell and use the following command to copy the key to\nyour validator:"),(0,n.kt)("pre",{parentName:"admonition"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"scp /path/to/source/<filename> <username>@<validator_ip>:~\n")),(0,n.kt)("p",{parentName:"admonition"}," Type your password."))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Relocating keystore file to right place")),(0,n.kt)("p",{parentName:"li"}," Your keystore file is copied to ",(0,n.kt)("inlineCode",{parentName:"p"},"/home/test/"),"."),(0,n.kt)("p",{parentName:"li"}," Copy back keystore file to the ",(0,n.kt)("inlineCode",{parentName:"p"},"/var/lib/eCredits/datadir/keystore")," location."),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"cd /var/lib/eCredits/datadir\n\nsudo bash\n\ncd keystore\n\nsudo cp /home/test/<filename> /var/lib/eCredits/datadir/keystore\n")),(0,n.kt)("p",{parentName:"li"},"After copying the keystore file back to your Validator, you can use the ",(0,n.kt)("inlineCode",{parentName:"p"},"ls")," command to check if the file has been successfully copied."))))}u.isMDXComponent=!0}}]);